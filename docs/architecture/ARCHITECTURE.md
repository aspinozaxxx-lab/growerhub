# Архитектура системы

Компоненты:
- Frontend (React).
- Backend (Java).
- Firmware (C++ src).
- Devices (железо).
- DB.
- MQTT broker.

Каналы:
- Frontend <-> Backend: REST.
- Backend <-> Devices: MQTT.

Принципы:
- REST и MQTT - тонкие адаптеры.
- Бизнес-логика - в доменах backend и в модулях firmware.
- Frontend не является источником правды.
- Форматы MQTT payload (state/cmd/ack) - контракт системы; изменения требуют обновления docs/architecture и ADR при исключениях.

Источники правды (концептуально):
- Device: фактическое состояние железа.
- Backend DB: история, конфигурация, устойчивое состояние.
- Shadow/кэши: производные данные.
- Frontend: производное представление.

ASCII-схема:

+-----------+     REST     +-----------+         +---------+
| Frontend  | <--------->  | Backend   | <-----> |   DB    |
+-----------+              +-----------+         +---------+
                                |
                                v
                           +-----------+
                           | MQTT      |
                           | broker    |
                           +-----------+
                                |
                                v
                           +-----------+
                           | Devices   |
                           +-----------+
